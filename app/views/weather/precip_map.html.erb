<% @title = "Daily Total Precipitation Grid"%>

<% content_for :welcome do %>
  <%= image_tag "icons/precip-map-250px.png" %>
  <h2><%= @title %></h2>
  <p>Precipitation data is pulled from gridded daily total precipitation datasets generated by the National Oceanographic and Atmospheric Administration and provided here for easy access.</p>
<% end %>

<%= content_for :scripts do %>
  <script lang="js">
    function regionMap(latitude, longitude) {
      latitude = latitude.toFixed(1);
      longitude = longitude.toFixed(1);
      console.log("Clicked on " + latitude.toString() + ", " + longitude.toString())
      $('#latitude').val(latitude);
      $('#longitude').val(longitude);
      return false;
    }
  </script>
<% end %>

<h2><%= @title %></h2>

<hr>

<h4>Total daily precipitation map for Wisconsin and surrounding states for <%= @date %>:</h4>

<%= render partial: "partials/date_changer", locals: { action: :precip_map } %>

<p><img src="<%= @map_image %>" usemap="#latlong"/></p>

<p style="font-size: smaller;"><i>Note: Map color scale is based on min/max daily precipitation across region. Map may take a few moments to load if it hasn't already been created. Precipitation data is not available for Canada from our data source.</i></p>

<hr>

<%= render partial: "partials/gridmap"%>

<h4>View/Download Precipitation Data Time Series</h4>

<p style="font-size: smaller;"><i>Note: You can click on the map to set the latitude and longitude to within half a degree.</i></p>

<%= render partial: "grid_selector" %>

<p><a href="/weather/precip_map.csv">Download the entire grid of data in CSV format</a></p>

<br>

<%= link_to "Back", :back %>
