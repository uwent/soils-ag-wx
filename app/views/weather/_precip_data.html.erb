<% if @data %>

<% content_for :scripts do %>
  <script>
    function copy() {
      navigator.clipboard.writeText(document.getElementById("data-container").outerHTML);
      $('#copy-confirm').fadeIn();
    }
  </script>
<% end %>

<hr>

<div id="data-container">
  <h4>Precipitation data series</h4>
  <p>
    <b>Location:</b> <%= @lat %>&deg;N, <%= @long %>&deg;W<br>
    <b>Date range:</b> <%= @start_date %> to <%= @end_date %><br>
    <b>Days:</b> <%= @data.size %>
  </p>
  <table class="grid-table">
    <thead>
      <tr>
        <th>Day</th>
        <th>Date</th>
        <th>Precip<br>(mm)</th>
        <th>Cumul.<br>precip<br>(mm)</th>
        <th>Precip<br>(in)</th>
        <th>Cumul.<br>precip<br>(in)</th>
      </tr>
    </thead>
    <tbody>
    <% @data.each_with_index do |day, i| %>
      <tr>
        <td><%= i + 1 %>
        <td><%= day[:date] %></td>
        <td><%= sprintf("%.2f", day[:value]) %></td>
        <td><%= sprintf("%.2f", day[:cumulative_value]) %></td>
        <td><%= sprintf("%.2f", (day[:value] / 25.4).round(2)) %></td>
        <td><%= sprintf("%.2f", (day[:cumulative_value] / 25.4).round(2)) %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>

<p>
  <%= submit_tag "Copy to clipboard", onclick: "copy()" %>
  <span id="copy-confirm" style="display:none;"> Copied!</span>
</p>

<% else %>

<p>No data!</p>

<% end %>
